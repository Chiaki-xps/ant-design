# Ant Design 其他配置文件分析

## 📋 其他配置文件概览

### 配置文件分类

- **GitHub 配置**: PR 模板、Issue 模板、Dependabot、Actions
- **代码质量工具**: Prettier、Lint-staged、Husky
- **依赖管理**: npm-check-updates、依赖检查
- **测试工具**: Puppeteer、Jest 相关配置
- **开发工具**: Git 忽略、编辑器配置
- **其他工具**: 各种辅助配置文件

## 🔧 GitHub 配置文件

### 1. .github/PULL_REQUEST_TEMPLATE.md - PR 模板

#### 模板结构

```markdown
<!--
First of all, thank you for your contribution! 😄
For requesting to pull a new feature or bugfix, please send it from a feature/bugfix branch based on the `master` branch.
Before submitting your pull request, please make sure the checklist below is filled out.
Your pull requests will be merged after one of the collaborators approves.
Thank you!
-->

[中文版模板 / Chinese template](https://github.com/ant-design/ant-design/blob/master/.github/PULL_REQUEST_TEMPLATE_CN.md?plain=1)
```

#### 贡献类型分类

```markdown
### 🤔 This is a ...

- [ ] 🆕 New feature
- [ ] 🐞 Bug fix
- [ ] 📝 Site / documentation improvement
- [ ] 📽️ Demo improvement
- [ ] 💄 Component style improvement
- [ ] 🤖 TypeScript definition improvement
- [ ] 📦 Bundle size optimization
- [ ] ⚡️ Performance optimization
- [ ] ⭐️ Feature enhancement
- [ ] 🌐 Internationalization
- [ ] 🛠 Refactoring
- [ ] 🎨 Code style optimization
- [ ] ✅ Test Case
- [ ] 🔀 Branch merge
- [ ] ⏩ Workflow
- [ ] ⌨️ Accessibility improvement
- [ ] ❓ Other (about what?)
```

#### 必填信息

```markdown
### 🔗 Related Issues

> - Describe the source of related requirements, such as links to relevant issue discussions.
> - For example: close #xxxx, fix #xxxx

### 💡 Background and Solution

> - The specific problem to be addressed.
> - List the final API implementation and usage if needed.
> - If there are UI/interaction changes, consider providing screenshots or GIFs.

### 📝 Change Log

> - Read [Keep a Changelog](https://keepachangelog.com/en/1.1.0/)! Track your changes, like a cat tracks a laser pointer.
> - Describe the impact of the changes on developers, not the solution approach.
> - Reference: https://ant.design/changelog

| Language   | Changelog |
| ---------- | --------- |
| 🇺🇸 English |           |
| 🇨🇳 Chinese |           |
```

### 2. .github/dependabot.yml - 依赖更新配置

#### 配置概览

```yaml
version: 2
updates:
  - package-ecosystem: npm
    directory: /
    schedule:
      interval: daily
      time: '05:00'
      timezone: Asia/Shanghai
    groups:
      dependencies:
        dependency-type: production
        update-types: [major, minor]
      dev-dependencies:
        dependency-type: development
        update-types: [major]
    ignore:
      - dependency-name: 'rc-*'
      - dependency-name: '@rc-component*'
      - dependency-name: '@ant-design*'
      - dependency-name: dayjs
        versions: [1.x]

  - package-ecosystem: github-actions
    directory: /
    schedule:
      interval: daily
    labels:
      - github-actions
      - dependencies
      - skip-verify-files
```

#### 核心功能

1. **自动依赖更新**: 每日检查依赖更新
2. **分组更新**: 生产依赖和开发依赖分别处理
3. **忽略特定包**: 忽略内部包和特定版本
4. **GitHub Actions 更新**: 自动更新 Actions 版本
5. **时区设置**: 使用上海时区

#### 更新策略

- **生产依赖**: 接受 major 和 minor 版本更新
- **开发依赖**: 仅接受 major 版本更新
- **忽略规则**: 忽略内部组件库和特定版本

### 3. .github/ISSUE_TEMPLATE/ - Issue 模板

#### 模板类型

- **Bug Report**: 问题报告模板
- **Feature Request**: 功能请求模板
- **Question**: 问题咨询模板
- **Documentation**: 文档相关模板

## 🛠️ 代码质量工具配置

### 1. .prettierrc - Prettier 格式化配置

#### 配置概览

```json
{
  "singleQuote": true,
  "jsxSingleQuote": false,
  "trailingComma": "all",
  "printWidth": 100,
  "proseWrap": "never",
  "importOrder": ["^(react|react-dom)$", "^([a-z]|@[a-z])", "", ".*"],
  "plugins": ["@ianvs/prettier-plugin-sort-imports"],
  "overrides": [
    {
      "files": ".prettierrc",
      "options": {
        "parser": "json"
      }
    }
  ]
}
```

#### 核心配置

1. **引号风格**: 单引号 (JavaScript)，双引号 (JSX)
2. **尾随逗号**: 所有位置都添加
3. **行宽限制**: 100 字符
4. **导入排序**: 自动排序导入语句
5. **插件支持**: 导入排序插件

#### 导入排序规则

```json
"importOrder": [
  "^(react|react-dom)$",  // React 相关
  "^([a-z]|@[a-z])",     // 第三方包
  "",                     // 空行分隔
  ".*"                    // 相对路径
]
```

### 2. .lintstagedrc.json - Lint-staged 配置

#### 配置概览

```json
{
  "*.{ts,tsx,js,jsx,css,mjs,json}": ["biome check --write --no-errors-on-unmatched", "eslint"],
  "*.{md,yml}": ["prettier --ignore-unknown --write"]
}
```

#### 核心功能

1. **代码文件**: 使用 Biome 和 ESLint 检查
2. **文档文件**: 使用 Prettier 格式化
3. **自动修复**: 支持自动修复问题
4. **错误处理**: 忽略未匹配文件的错误

### 3. .husky/pre-commit - Git Hooks 配置

#### 配置概览

```bash
lint-staged
```

#### 核心功能

1. **提交前检查**: 在 git commit 前运行 lint-staged
2. **自动格式化**: 自动格式化暂存的文件
3. **质量保证**: 确保提交的代码符合规范

## 📦 依赖管理配置

### 1. .ncurc.js - npm-check-updates 配置

#### 配置概览

```javascript
const rcOrg = ['@rc-component/', 'rc-'];
const check = ['@ant-design/', ...rcOrg];

module.exports = {
  packageFile: path.resolve(__dirname, './package.json'),
  upgrade: false, // use `npx npm-check-updates -u` to upgrade
  packageManager: 'npm',
  dep: ['prod'], // check only prod dependencies
  filter: (name) => {
    if (name === '@ant-design/cssinjs') {
      return false;
    }
    return check.some((prefix) => name.startsWith(prefix));
  },
  target: () => `semver`,
};
```

#### 核心功能

1. **依赖检查**: 检查特定前缀的依赖更新
2. **过滤规则**: 忽略特定包
3. **版本策略**: 使用语义化版本
4. **手动升级**: 需要手动执行升级命令

#### 检查范围

- **@ant-design/**: Ant Design 相关包
- **@rc-component/**: RC 组件库
- **rc-**: RC 工具包
- **排除**: @ant-design/cssinjs

### 2. .depslintrc.js - 依赖检查配置

#### 配置概览

```javascript
module.exports = {
  ignore: [
    '**/~*/**',
    '**/_*/**',
    '**/icon/**',
    '**/__tests__/**',
    '**/style/**',
    '**/locale/**',
    '**/*-provider/**',
    '**/*.json',
  ],
  modulePattern: [
    {
      pattern: /ConfigContext.*renderEmpty/s,
      module: '../empty',
    },
    {
      pattern: /ConfigConsumer.*renderEmpty/s,
      module: '../empty',
    },
    {
      pattern: /config-provider\/context.*renderEmpty/s,
      module: '../empty',
    },
  ],
};
```

#### 核心功能

1. **忽略规则**: 忽略特定目录和文件
2. **模块模式**: 定义模块依赖关系
3. **依赖检查**: 检查组件间的依赖关系

#### 忽略规则

- **临时文件**: `**/~*/**`, `**/_*/**`
- **工具文件**: `**/icon/**`, `**/style/**`, `**/locale/**`
- **测试文件**: `**/__tests__/**`
- **配置文件**: `**/*.json`

## 🧪 测试工具配置

### 1. jest-puppeteer.config.js - Puppeteer 配置

#### 配置概览

```javascript
module.exports = {
  launch: {
    headless: 'new',
    ignoreDefaultArgs: ['--disable-extensions'],
    args: [
      // Required for Docker version of Puppeteer
      '--no-sandbox',
      '--disable-setuid-sandbox',
      // This will write shared memory files into /tmp instead of /dev/shm,
      // because Docker's default for /dev/shm is 64MB
      '--disable-dev-shm-usage',
    ],
  },
};
```

#### 核心功能

1. **无头模式**: 使用新的无头模式
2. **Docker 支持**: 适配 Docker 环境
3. **内存优化**: 优化共享内存使用
4. **沙箱配置**: 禁用沙箱以提高兼容性

#### 启动参数

- **--no-sandbox**: 禁用沙箱
- **--disable-setuid-sandbox**: 禁用 setuid 沙箱
- **--disable-dev-shm-usage**: 禁用 /dev/shm 使用

### 2. .jest.image.js - 图像测试配置

#### 配置概览

```javascript
module.exports = {
  verbose: true,
  testEnvironment: 'jsdom',
  setupFiles: ['./tests/setup.ts', 'jest-canvas-mock'],
  setupFilesAfterEnv: ['./tests/setupAfterEnv.ts'],
  moduleFileExtensions: ['ts', 'tsx', 'js', 'jsx', 'json', 'md'],
  modulePathIgnorePatterns: ['/_site/'],
  moduleNameMapper: {
    '/\\.(css|less)$/': 'identity-obj-proxy',
    '^antd$': '<rootDir>/components/index',
    '^antd/es/(.*)$': '<rootDir>/components/$1',
    '^antd/lib/(.*)$': '<rootDir>/components/$1',
    '^antd/locale/(.*)$': '<rootDir>/components/locale/$1',
  },
  testPathIgnorePatterns: ['/node_modules/', 'dekko', 'node'],
  transform: {
    '\\.tsx?$': './node_modules/@ant-design/tools/lib/jest/codePreprocessor',
    '\\.(m?)js$': './node_modules/@ant-design/tools/lib/jest/codePreprocessor',
    '\\.md$': './node_modules/@ant-design/tools/lib/jest/demoPreprocessor',
    '\\.(jpg|png|gif|svg)$': './node_modules/@ant-design/tools/lib/jest/imagePreprocessor',
  },
  testRegex: '.*\\.test\\.(j|t)sx?$',
  collectCoverageFrom: [
    'components/**/*.{ts,tsx}',
    '!components/*/style/index.tsx',
    '!components/style/index.tsx',
    '!components/*/locale/index.tsx',
    '!components/*/__tests__/type.test.tsx',
    '!components/**/*/interface.{ts,tsx}',
    '!components/*/__tests__/image.test.{ts,tsx}',
    '!components/__tests__/node.test.tsx',
    '!components/*/demo/*.tsx',
    '!components/*/design/**',
  ],
  transformIgnorePatterns: [
    '[/\\\\]node_modules[/\\\\](?!(@ant-design|rc-|@rc-component|countup\\.js|@babel|react-sticky-box|rc-tween-one|@asamuzakjp/css-color))[^/\\\\]+?[/\\\\](?!(es)[/\\\\])',
  ],
  globals: {
    'ts-jest': {
      tsConfig: './tsconfig.test.json',
    },
  },
  testEnvironmentOptions: {
    url: 'http://localhost',
  },
  maxWorkers: '50%',
};
```

#### 核心功能

1. **图像测试**: 专门用于图像快照测试
2. **Canvas 模拟**: 使用 jest-canvas-mock
3. **图像预处理**: 专门的图像文件处理器
4. **覆盖率收集**: 收集图像测试覆盖率

## 🔧 开发工具配置

### 1. .gitignore - Git 忽略配置

#### 忽略文件类型

```gitignore
# IDE 文件
*.iml
.idea/
.ipr
.iws
.vscode/

# 系统文件
.DS_Store
Thumbs.db
*~
~*

# 构建产物
dist/
/lib
/es
/locale
_site
_data

# 依赖文件
node_modules/
yarn.lock
package-lock.json
pnpm-lock.yaml
bun.lock*

# 日志文件
*.log
*.log.*
npm-debug.log
nohup.out

# 测试文件
/coverage
__diff_output__/
__image_snapshots__/
/jest-stare
/imageSnapshots*
/imageDiffSnapshots
/visualRegressionReport*

# 临时文件
*.tmp
*.bak
*.diff
*.patch
*.swp
*.swo

# 文档模板
scripts/previewEditor/index.html
components/version/version.ts
components/version/version.tsx
components/version/token.json
components/version/token-meta.json
.dumi/tmp*
.dumi/preset/components-changelog*
.dumi/preset/misc-changelog.json

# 环境文件
.env
examples/
```

#### 核心功能

1. **IDE 文件**: 忽略各种 IDE 配置文件
2. **构建产物**: 忽略编译和构建产生的文件
3. **依赖文件**: 忽略包管理器的锁文件
4. **测试文件**: 忽略测试产生的临时文件
5. **临时文件**: 忽略各种临时和备份文件

### 2. .editorconfig - 编辑器配置

#### 配置概览

```ini
root = true

[*]
charset = utf-8
end_of_line = lf
insert_final_newline = true
trim_trailing_whitespace = true
indent_style = space
indent_size = 2

[*.md]
trim_trailing_whitespace = false
```

#### 核心功能

1. **编码设置**: UTF-8 编码
2. **换行符**: LF (Unix 风格)
3. **缩进设置**: 2 空格缩进
4. **文件结尾**: 自动添加换行符
5. **空白处理**: 自动清理尾随空白

### 3. .npmrc - npm 配置

#### 配置概览

```ini
registry=https://registry.npmjs.org/
save-exact=true
```

#### 核心功能

1. **注册表**: 使用官方 npm 注册表
2. **精确版本**: 保存精确的版本号
3. **依赖管理**: 确保依赖版本的一致性

## 📊 其他工具配置

### 1. renovate.json - Renovate 配置

#### 配置概览

```json
{
  "extends": ["config:base"],
  "schedule": ["before 4am on monday"],
  "timezone": "Asia/Shanghai",
  "packageRules": [
    {
      "matchUpdateTypes": ["minor", "patch"],
      "matchCurrentVersion": "!/^0/",
      "automerge": true
    }
  ]
}
```

#### 核心功能

1. **自动更新**: 自动更新依赖
2. **时间设置**: 每周一凌晨 4 点前更新
3. **时区设置**: 使用上海时区
4. **自动合并**: 自动合并 minor 和 patch 更新

### 2. .dockerignore - Docker 忽略配置

#### 配置概览

```dockerignore
node_modules
npm-debug.log
.git
.gitignore
README.md
.env
.nyc_output
coverage
.nyc_output
.coverage
```

#### 核心功能

1. **构建优化**: 减少 Docker 构建上下文
2. **安全考虑**: 排除敏感文件
3. **性能优化**: 排除不必要的文件

### 3. .surgeignore - Surge 忽略配置

#### 配置概览

```surgeignore
node_modules
.git
```

#### 核心功能

1. **部署优化**: 排除不需要部署的文件
2. **性能优化**: 减少部署包大小

## 🎯 配置最佳实践

### 1. 自动化流程

- **Git Hooks**: 提交前自动检查代码质量
- **依赖更新**: 自动检查和更新依赖
- **CI/CD**: 自动化测试和部署流程

### 2. 代码质量保障

- **多工具集成**: ESLint + Biome + Prettier
- **格式化规则**: 统一的代码风格
- **提交规范**: 标准化的 PR 和 Issue 模板

### 3. 开发体验优化

- **编辑器配置**: 统一的编辑器设置
- **路径别名**: 简化导入路径
- **热重载**: 开发时的快速反馈

### 4. 测试策略

- **多环境测试**: 支持不同浏览器环境
- **图像测试**: 视觉回归测试
- **覆盖率监控**: 保证代码质量

---

**总结**: Ant Design 的其他配置文件体系非常完善，涵盖了开发工具、代码质量、依赖管理、测试工具等各个方面。这些配置体现了企业级项目对开发体验、代码质量和自动化流程的重视，是学习现代前端项目配置的宝贵资源。
